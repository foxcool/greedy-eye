swagger: "2.0"
info:
  title: api/models/account.proto
  version: version not set
tags:
  - name: StorageService
  - name: AssetService
  - name: AuthService
  - name: MessengerService
  - name: PortfolioService
  - name: PriceService
  - name: RuleService
  - name: UserService
consumes:
  - application/json
produces:
  - application/json
paths:
  /api/v1/accounts:
    get:
      operationId: StorageService_ListAccounts
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListAccountsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: userId
          description: Filter by user
          in: query
          required: false
          type: string
        - name: type
          description: Filter by AccountType
          in: query
          required: false
          type: string
          enum:
            - ACCOUNT_TYPE_UNSPECIFIED
            - ACCOUNT_TYPE_WALLET
            - ACCOUNT_TYPE_EXCHANGE
            - ACCOUNT_TYPE_BANK
            - ACCOUNT_TYPE_BROKER
          default: ACCOUNT_TYPE_UNSPECIFIED
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- Account operations ---'
      operationId: StorageService_CreateAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAccount'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: account
          description: user_id, name, type required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsAccount'
      tags:
        - StorageService
  /api/v1/accounts/{account.id}:
    put:
      operationId: StorageService_UpdateAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAccount'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: account.id
          description: Unique identifier (UUID)
          in: path
          required: true
          type: string
        - name: account
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              userId:
                type: string
                title: ID of the user owning this account
              name:
                type: string
                title: User-defined name (e.g., "My Binance Spot", "Ledger Nano S")
              description:
                type: string
                title: Optional longer description
              type:
                $ref: '#/definitions/modelsAccountType'
                title: Type of the account
              data:
                type: object
                additionalProperties:
                  type: string
                description: Flexible map for connection parameters, API keys, addresses etc. Needs careful handling due to sensitive data.
              createdAt:
                type: string
                format: date-time
                title: Timestamp of creation
              updatedAt:
                type: string
                format: date-time
                title: Timestamp of last update
              subtype:
                $ref: '#/definitions/modelsExchangeAccountSubtype'
                description: Sub-type for exchange accounts (spot, futures, margin)
                title: Exchange-specific fields (optional, only for ACCOUNT_TYPE_EXCHANGE)
              parentAccountId:
                type: string
                title: Parent account ID for hierarchical structure (e.g., futures under main exchange account)
              externalApiKeyId:
                type: string
                title: Direct reference to ExternalAPIKey for this account
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/accounts/{id}:
    get:
      operationId: StorageService_GetAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAccount'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeleteAccount
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/api-keys:
    get:
      operationId: StorageService_ListAPIKeys
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListAPIKeysResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: userId
          in: query
          required: false
          type: string
        - name: enabled
          in: query
          required: false
          type: boolean
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- APIKey operations ---'
      operationId: StorageService_CreateAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAPIKey'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: apiKey
          description: name, user_id, scopes required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsAPIKey'
      tags:
        - StorageService
  /api/v1/api-keys/{apiKey.id}:
    put:
      operationId: StorageService_UpdateAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAPIKey'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: apiKey.id
          in: path
          required: true
          type: string
        - name: apiKey
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              name:
                type: string
              description:
                type: string
              userId:
                type: string
              scopes:
                type: array
                items:
                  type: string
              createdAt:
                type: string
                format: date-time
              lastUsedAt:
                type: string
                format: date-time
              expiresAt:
                type: string
                format: date-time
              enabled:
                type: boolean
              keyPrefix:
                type: string
                title: First 8 characters for display
              usageCount:
                type: integer
                format: int32
              rateLimit:
                $ref: '#/definitions/modelsRateLimitConfig'
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/api-keys/{id}:
    get:
      operationId: StorageService_GetAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAPIKey'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeleteAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/assets:
    get:
      operationId: StorageService_ListAssets
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListAssetsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Number of assets to return
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Token for fetching the next page
          in: query
          required: false
          type: string
        - name: tags
          description: Filter by tags
          in: query
          required: false
          type: array
          items:
            type: string
          collectionFormat: multi
      tags:
        - StorageService
    post:
      summary: '--- Asset operations ---'
      operationId: StorageService_CreateAsset
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAsset'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: asset
          description: ID might be empty if generated server-side
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsAsset'
      tags:
        - StorageService
  /api/v1/assets/{asset.id}:
    put:
      operationId: StorageService_UpdateAsset
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAsset'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: asset.id
          in: path
          required: true
          type: string
        - name: asset
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              name:
                type: string
              type:
                $ref: '#/definitions/modelsAssetType'
              symbol:
                type: string
              tags:
                type: array
                items:
                  type: string
              createdAt:
                type: string
                format: date-time
              updatedAt:
                type: string
                format: date-time
            title: Must include ID and fields to update
        - name: updateMask
          description: Specifies which fields to update
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/assets/{assetId}/enrich:
    post:
      summary: 'Example business logic method: Fetches data from external sources and updates the asset info.'
      operationId: AssetService_EnrichAssetData
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAsset'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: assetId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/AssetServiceEnrichAssetDataBody'
      tags:
        - AssetService
  /api/v1/assets/{assetId}/similar:
    get:
      summary: 'Example: Find assets similar to a given one based on tags, type, etc.'
      operationId: AssetService_FindSimilarAssets
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListAssetsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: assetId
          description: Find assets similar to this one
          in: path
          required: true
          type: string
        - name: limit
          description: Max number of similar assets to return
          in: query
          required: false
          type: integer
          format: int32
      tags:
        - AssetService
  /api/v1/assets/{id}:
    get:
      operationId: StorageService_GetAsset
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsAsset'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeleteAsset
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/auth/jwt/create:
    post:
      summary: JWT management
      operationId: AuthService_CreateJWT
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesCreateJWTResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesCreateJWTRequest'
      tags:
        - AuthService
  /api/v1/auth/jwt/refresh:
    post:
      operationId: AuthService_RefreshJWT
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesRefreshJWTResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesRefreshJWTRequest'
      tags:
        - AuthService
  /api/v1/auth/jwt/validate:
    post:
      operationId: AuthService_ValidateJWT
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesValidateJWTResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesValidateJWTRequest'
      tags:
        - AuthService
  /api/v1/external-api-keys:
    get:
      operationId: StorageService_ListExternalAPIKeys
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListExternalAPIKeysResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: userId
          in: query
          required: false
          type: string
        - name: provider
          in: query
          required: false
          type: string
        - name: sandbox
          in: query
          required: false
          type: boolean
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- ExternalAPIKey operations ---'
      operationId: StorageService_CreateExternalAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsExternalAPIKey'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: externalApiKey
          description: user_id, provider required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsExternalAPIKey'
      tags:
        - StorageService
  /api/v1/external-api-keys/{externalApiKey.id}:
    put:
      operationId: StorageService_UpdateExternalAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsExternalAPIKey'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: externalApiKey.id
          in: path
          required: true
          type: string
        - name: externalApiKey
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              userId:
                type: string
                title: User ID (null for system-wide keys)
              provider:
                type: string
                title: e.g., "binance", "gate.io", "coingecko"
              encryptedApiKey:
                type: string
              encryptedApiSecret:
                type: string
              encryptedPassphrase:
                type: string
                title: For some exchanges
              sandbox:
                type: boolean
                title: Whether this is a sandbox/test key
              createdAt:
                type: string
                format: date-time
              updatedAt:
                type: string
                format: date-time
              isSystemKey:
                type: boolean
                description: True if this is a system-wide key (user_id should be null)
                title: System key support
              allowedUserIds:
                type: array
                items:
                  type: string
                title: Whitelist of users who can use this key (empty = all users)
              permissions:
                type: array
                items:
                  type: string
                title: e.g., ["read", "trade", "withdraw"]
              status:
                $ref: '#/definitions/modelsKeyStatus'
                description: Current status of the key
                title: Lifecycle management
              expiresAt:
                type: string
                format: date-time
                title: Expiration time (optional)
              lastUsedAt:
                type: string
                format: date-time
                title: Last time key was used
              usageCount:
                type: integer
                format: int32
                title: Number of times key has been used
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/external-api-keys/{id}:
    get:
      operationId: StorageService_GetExternalAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsExternalAPIKey'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeleteExternalAPIKey
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/holdings:
    get:
      operationId: StorageService_ListHoldings
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListHoldingsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: portfolioId
          in: query
          required: false
          type: string
        - name: accountId
          in: query
          required: false
          type: string
        - name: assetId
          in: query
          required: false
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- Holdings operations ---'
      operationId: StorageService_CreateHolding
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsHolding'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: holding
          description: asset_id, amount, decimals required. One of portfolio_id or account_id required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsHolding'
      tags:
        - StorageService
  /api/v1/holdings/{holding.id}:
    put:
      operationId: StorageService_UpdateHolding
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsHolding'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: holding.id
          description: Unique identifier (UUID)
          in: path
          required: true
          type: string
        - name: holding
          description: Must include ID and fields to update (e.g., amount)
          in: body
          required: true
          schema:
            type: object
            properties:
              amount:
                type: string
                format: int64
                title: Value of the asset in the smallest unit
              decimals:
                type: integer
                format: int64
                title: Number of decimal places for the amount
              assetId:
                type: string
                title: ID of the Asset
              accountId:
                type: string
                title: ID of the Account where the asset is held
              portfolioId:
                type: string
                title: ID of the Portfolio this holding belongs to
              createdAt:
                type: string
                format: date-time
                title: Timestamp of creation
              updatedAt:
                type: string
                format: date-time
                title: Timestamp of last update
            title: Must include ID and fields to update (e.g., amount)
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/holdings/{id}:
    get:
      operationId: StorageService_GetHolding
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsHolding'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/portfolios:
    get:
      operationId: StorageService_ListPortfolios
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListPortfoliosResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: userId
          in: query
          required: false
          type: string
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- Portfolio operations ---'
      operationId: StorageService_CreatePortfolio
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsPortfolio'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: portfolio
          description: user_id and name are required. ID empty if server-generated.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsPortfolio'
      tags:
        - StorageService
  /api/v1/portfolios/{id}:
    get:
      operationId: StorageService_GetPortfolio
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsPortfolio'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeletePortfolio
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/portfolios/{portfolio.id}:
    put:
      operationId: StorageService_UpdatePortfolio
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsPortfolio'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: portfolio.id
          description: Unique identifier (UUID)
          in: path
          required: true
          type: string
        - name: portfolio
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              userId:
                type: string
                title: ID of the user owning this portfolio
              name:
                type: string
                title: User-defined name (e.g., "Long Term Crypto", "Trading")
              description:
                type: string
                title: Optional longer description
              data:
                type: object
                additionalProperties:
                  $ref: '#/definitions/protobufAny'
                title: Additional data (e.g., strategy, notes, regulated balance of assets, etc.)
              createdAt:
                type: string
                format: date-time
                title: Timestamp of creation
              updatedAt:
                type: string
                format: date-time
                title: Timestamp of last update
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/portfolios/{portfolioId}/calculate-value:
    post:
      summary: Calculates the current total value of a portfolio in a specified currency.
      operationId: PortfolioService_CalculatePortfolioValue
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesPortfolioValueResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: portfolioId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/PortfolioServiceCalculatePortfolioValueBody'
      tags:
        - PortfolioService
  /api/v1/portfolios/{portfolioId}/performance:
    post:
      summary: Retrieves performance metrics for a portfolio over a specified period.
      operationId: PortfolioService_GetPortfolioPerformance
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesPortfolioPerformanceResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: portfolioId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/PortfolioServiceGetPortfolioPerformanceBody'
      tags:
        - PortfolioService
  /api/v1/prices:
    delete:
      operationId: StorageService_DeletePrices
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: assetId
          in: query
          required: false
          type: string
        - name: baseAssetId
          in: query
          required: false
          type: string
        - name: from
          in: query
          required: false
          type: string
          format: date-time
        - name: to
          in: query
          required: false
          type: string
          format: date-time
        - name: sourceId
          description: Filter by source
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: |-
        --- Price operations ---
        Assuming prices are immutable once created, so no UpdatePrice.
      operationId: StorageService_CreatePrice
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsPrice'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: price
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsPrice'
      tags:
        - StorageService
  /api/v1/prices/bulk:
    post:
      operationId: StorageService_CreatePrices
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesCreatePricesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: prices
          in: body
          required: true
          schema:
            type: array
            items:
              type: object
              $ref: '#/definitions/modelsPrice'
      tags:
        - StorageService
  /api/v1/prices/fetch-external:
    post:
      summary: Triggers fetching of latest prices from configured external sources and stores them using StorageService.
      operationId: PriceService_FetchExternalPrices
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesFetchExternalPricesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesFetchExternalPricesRequest'
      tags:
        - PriceService
  /api/v1/prices/{assetId}/{baseAssetId}/history:
    get:
      operationId: StorageService_ListPriceHistory
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListPriceHistoryResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: assetId
          in: path
          required: true
          type: string
        - name: baseAssetId
          in: path
          required: true
          type: string
        - name: from
          description: Start of the time range
          in: query
          required: false
          type: string
          format: date-time
        - name: to
          description: End of the time range
          in: query
          required: false
          type: string
          format: date-time
        - name: sourceId
          description: Filter by source
          in: query
          required: false
          type: string
        - name: pageSize
          description: Pagination for large history
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/prices/{assetId}/{baseAssetId}/intervals:
    get:
      operationId: StorageService_ListPricesByInterval
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListPriceHistoryResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: assetId
          in: path
          required: true
          type: string
        - name: baseAssetId
          in: path
          required: true
          type: string
        - name: from
          in: query
          required: false
          type: string
          format: date-time
        - name: to
          in: query
          required: false
          type: string
          format: date-time
        - name: interval
          description: e.g., "hourly", "daily", "weekly" - specific values TBD
          in: query
          required: false
          type: string
        - name: sourceId
          description: Filter by source
          in: query
          required: false
          type: string
        - name: pageSize
          description: Pagination
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/prices/{assetId}/{baseAssetId}/latest:
    get:
      operationId: StorageService_GetLatestPrice
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsPrice'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: assetId
          in: path
          required: true
          type: string
        - name: baseAssetId
          in: path
          required: true
          type: string
        - name: sourceId
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/prices/{id}:
    delete:
      operationId: StorageService_DeletePrice
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/rule-executions:
    get:
      operationId: StorageService_ListRuleExecutions
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListRuleExecutionsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: query
          required: false
          type: string
        - name: portfolioId
          in: query
          required: false
          type: string
        - name: userId
          in: query
          required: false
          type: string
        - name: status
          in: query
          required: false
          type: string
          enum:
            - EXECUTION_STATUS_UNKNOWN
            - EXECUTION_STATUS_PENDING
            - EXECUTION_STATUS_IN_PROGRESS
            - EXECUTION_STATUS_COMPLETED
            - EXECUTION_STATUS_FAILED
            - EXECUTION_STATUS_CANCELLED
          default: EXECUTION_STATUS_UNKNOWN
        - name: from
          in: query
          required: false
          type: string
          format: date-time
        - name: to
          in: query
          required: false
          type: string
          format: date-time
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- RuleExecution operations ---'
      operationId: StorageService_CreateRuleExecution
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRuleExecution'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleExecution
          description: rule_id required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsRuleExecution'
      tags:
        - StorageService
  /api/v1/rule-executions/{executionId}/cancel:
    post:
      operationId: RuleService_CancelRuleExecution
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: executionId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceCancelRuleExecutionBody'
      tags:
        - RuleService
  /api/v1/rule-executions/{id}:
    get:
      operationId: StorageService_GetRuleExecution
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRuleExecution'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/rule-executions/{ruleExecution.id}:
    put:
      operationId: StorageService_UpdateRuleExecution
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRuleExecution'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleExecution.id
          in: path
          required: true
          type: string
        - name: ruleExecution
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              ruleId:
                type: string
              portfolioId:
                type: string
                title: Optional scope - inherited from rule if not specified
              userId:
                type: string
              startedAt:
                type: string
                format: date-time
              completedAt:
                type: string
                format: date-time
              status:
                $ref: '#/definitions/modelsExecutionStatus'
              errorMessage:
                type: string
              createdTransactionIds:
                type: array
                items:
                  type: string
                title: Results produced by execution
              affectedHoldingIds:
                type: array
                items:
                  type: string
              transactionsCreated:
                type: integer
                format: int32
                title: Execution metrics
              executionSummary:
                type: object
                title: Rule-type specific execution details
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/rules:
    get:
      operationId: StorageService_ListRules
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListRulesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: userId
          in: query
          required: false
          type: string
        - name: portfolioId
          in: query
          required: false
          type: string
        - name: ruleType
          in: query
          required: false
          type: string
        - name: status
          in: query
          required: false
          type: string
          enum:
            - RULE_STATUS_UNKNOWN
            - RULE_STATUS_ACTIVE
            - RULE_STATUS_PAUSED
            - RULE_STATUS_DISABLED
            - RULE_STATUS_ERROR
          default: RULE_STATUS_UNKNOWN
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- Rule operations ---'
      operationId: StorageService_CreateRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: rule
          description: name, rule_type, portfolio_id, user_id required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsRule'
      tags:
        - StorageService
  /api/v1/rules/validate:
    post:
      summary: Rule validation and simulation
      operationId: RuleService_ValidateRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesValidateRuleResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: rule
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsRule'
      tags:
        - RuleService
  /api/v1/rules/{id}:
    get:
      operationId: StorageService_GetRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeleteRule
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/rules/{rule.id}:
    put:
      operationId: StorageService_UpdateRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: rule.id
          in: path
          required: true
          type: string
        - name: rule
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              name:
                type: string
              description:
                type: string
              ruleType:
                type: string
                title: e.g., "target_allocation", "monthly_withdrawal", "stop_loss", "dca"
              portfolioId:
                type: string
              userId:
                type: string
              status:
                $ref: '#/definitions/modelsRuleStatus'
              configuration:
                type: object
                title: Flexible configuration for any rule type
              schedule:
                $ref: '#/definitions/modelsRuleSchedule'
              createdAt:
                type: string
                format: date-time
              updatedAt:
                type: string
                format: date-time
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/rules/{ruleId}/disable:
    post:
      operationId: RuleService_DisableRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceDisableRuleBody'
      tags:
        - RuleService
  /api/v1/rules/{ruleId}/enable:
    post:
      summary: Rule status management
      operationId: RuleService_EnableRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceEnableRuleBody'
      tags:
        - RuleService
  /api/v1/rules/{ruleId}/execute:
    post:
      summary: Rule execution operations
      operationId: RuleService_ExecuteRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesExecuteRuleResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceExecuteRuleBody'
      tags:
        - RuleService
  /api/v1/rules/{ruleId}/execute-async:
    post:
      operationId: RuleService_ExecuteRuleAsync
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesExecuteRuleAsyncResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceExecuteRuleAsyncBody'
      tags:
        - RuleService
  /api/v1/rules/{ruleId}/pause:
    post:
      operationId: RuleService_PauseRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServicePauseRuleBody'
      tags:
        - RuleService
  /api/v1/rules/{ruleId}/resume:
    post:
      operationId: RuleService_ResumeRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsRule'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceResumeRuleBody'
      tags:
        - RuleService
  /api/v1/rules/{ruleId}/simulate:
    post:
      operationId: RuleService_SimulateRule
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesSimulateRuleResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: ruleId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RuleServiceSimulateRuleBody'
      tags:
        - RuleService
  /api/v1/telegram/alerts:
    post:
      summary: Manage user alert subscriptions
      operationId: MessengerService_ManageAlerts
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesManageAlertsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesManageAlertsRequest'
      tags:
        - MessengerService
  /api/v1/telegram/notifications:
    post:
      summary: Send notification to specific user
      operationId: MessengerService_SendNotification
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesSendNotificationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesSendNotificationRequest'
      tags:
        - MessengerService
  /api/v1/telegram/notifications/bulk:
    post:
      summary: Send bulk notifications to multiple users
      operationId: MessengerService_SendBulkNotifications
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesSendBulkNotificationsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesSendBulkNotificationsRequest'
      tags:
        - MessengerService
  /api/v1/telegram/sessions/{session.telegramId}:
    put:
      summary: Update user session context
      operationId: MessengerService_UpdateUserSession
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesUpdateUserSessionResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: session.telegramId
          description: Telegram user ID
          in: path
          required: true
          type: string
        - name: session
          description: SessionContext represents user conversation state
          in: body
          required: true
          schema:
            type: object
            properties:
              currentOperation:
                type: string
                description: 'Current operation: "trade", "portfolio_view", etc.'
              contextData:
                type: object
                additionalProperties:
                  type: string
                title: Key-value context data
              expiresAt:
                type: string
                format: date-time
                title: Session expiration time
              conversationHistory:
                type: array
                items:
                  type: string
                title: Recent conversation history
              state:
                type: string
                title: Current conversation state
            title: SessionContext represents user conversation state
      tags:
        - MessengerService
  /api/v1/telegram/sessions/{telegramId}:
    get:
      summary: Get user session information
      operationId: MessengerService_GetUserSession
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesGetUserSessionResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: telegramId
          in: path
          required: true
          type: string
      tags:
        - MessengerService
  /api/v1/telegram/stats:
    get:
      summary: Get bot statistics and health
      operationId: MessengerService_GetBotStats
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesGetBotStatsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: from
          description: Statistics from this time (optional)
          in: query
          required: false
          type: string
          format: date-time
        - name: to
          description: Statistics to this time (optional)
          in: query
          required: false
          type: string
          format: date-time
      tags:
        - MessengerService
  /api/v1/telegram/users:
    post:
      summary: Register new Telegram user or update existing
      operationId: MessengerService_RegisterTelegramUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesRegisterTelegramUserResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesRegisterTelegramUserRequest'
      tags:
        - MessengerService
  /api/v1/telegram/users/{telegramId}:
    get:
      summary: Get Telegram user information
      operationId: MessengerService_GetTelegramUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesGetTelegramUserResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: telegramId
          in: path
          required: true
          type: string
      tags:
        - MessengerService
  /api/v1/telegram/voice/process:
    post:
      summary: Process voice message (Speech-to-Text)
      operationId: MessengerService_ProcessVoiceMessage
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesProcessVoiceMessageResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesProcessVoiceMessageRequest'
      tags:
        - MessengerService
  /api/v1/telegram/voice/synthesize:
    post:
      summary: Convert text to speech
      operationId: MessengerService_ConvertTextToSpeech
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesConvertTextToSpeechResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesConvertTextToSpeechRequest'
      tags:
        - MessengerService
  /api/v1/telegram/webhook:
    post:
      summary: Process incoming Telegram webhook updates
      operationId: MessengerService_ProcessTelegramUpdate
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesProcessTelegramUpdateResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/servicesProcessTelegramUpdateRequest'
      tags:
        - MessengerService
  /api/v1/transactions:
    get:
      operationId: StorageService_ListTransactions
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/servicesListTransactionsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: type
          description: |2-
             - TRANSACTION_TYPE_EXTENDED: Complex transactionsz: DeFi, NFT, Governance, Gaming, etc.
             - TRANSACTION_TYPE_TRADE: Echanging one asset for another
             - TRANSACTION_TYPE_TRANSFER: Transferring asset between accounts (internal or external)
             - TRANSACTION_TYPE_DEPOSIT: Depositing asset into an account from outside the system
             - TRANSACTION_TYPE_WITHDRAWAL: Withdrawing asset from an account to outside the system
          in: query
          required: false
          type: string
          enum:
            - TRANSACTION_TYPE_UNSPECIFIED
            - TRANSACTION_TYPE_EXTENDED
            - TRANSACTION_TYPE_TRADE
            - TRANSACTION_TYPE_TRANSFER
            - TRANSACTION_TYPE_DEPOSIT
            - TRANSACTION_TYPE_WITHDRAWAL
          default: TRANSACTION_TYPE_UNSPECIFIED
        - name: status
          description: |2-
             - TRANSACTION_STATUS_PENDING: Transaction initiated but not confirmed
             - TRANSACTION_STATUS_PROCESSING: Transaction is being processed
             - TRANSACTION_STATUS_COMPLETED: Transaction successfully completed
             - TRANSACTION_STATUS_FAILED: Transaction failed
             - TRANSACTION_STATUS_CANCELLED: Transaction cancelled before completion
          in: query
          required: false
          type: string
          enum:
            - TRANSACTION_STATUS_UNSPECIFIED
            - TRANSACTION_STATUS_PENDING
            - TRANSACTION_STATUS_PROCESSING
            - TRANSACTION_STATUS_COMPLETED
            - TRANSACTION_STATUS_FAILED
            - TRANSACTION_STATUS_CANCELLED
          default: TRANSACTION_STATUS_UNSPECIFIED
        - name: accountId
          in: query
          required: false
          type: string
        - name: from
          in: query
          required: false
          type: string
          format: date-time
        - name: to
          in: query
          required: false
          type: string
          format: date-time
        - name: pageSize
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          in: query
          required: false
          type: string
      tags:
        - StorageService
    post:
      summary: '--- Transaction operations ---'
      operationId: StorageService_CreateTransaction
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsTransaction'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: transaction
          description: Required fields depend on type. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsTransaction'
      tags:
        - StorageService
  /api/v1/transactions/{id}:
    get:
      operationId: StorageService_GetTransaction
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsTransaction'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/transactions/{transaction.id}:
    put:
      operationId: StorageService_UpdateTransaction
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsTransaction'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: transaction.id
          description: Unique identifier (UUID)
          in: path
          required: true
          type: string
        - name: transaction
          description: Must include ID. Typically only 'status' or 'metadata' can be updated.
          in: body
          required: true
          schema:
            type: object
            properties:
              createdAt:
                type: string
                format: date-time
                title: Timestamp when the transaction occurred or was recorded
              updatedAt:
                type: string
                format: date-time
                title: Timestamp of last status update
              type:
                $ref: '#/definitions/modelsTransactionType'
                title: Type of the transaction
              status:
                $ref: '#/definitions/modelsTransactionStatus'
                title: Current status of the transaction
              accountId:
                type: string
                title: ID of the Account involved in the transaction
              data:
                type: object
                additionalProperties:
                  type: string
                title: Transaction data (e.g., external transaction ID, notes, )
            title: Must include ID. Typically only 'status' or 'metadata' can be updated.
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/users:
    post:
      summary: '--- User operations ---'
      operationId: StorageService_CreateUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsUser'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: user
          description: email, name required. ID empty.
          in: body
          required: true
          schema:
            $ref: '#/definitions/modelsUser'
      tags:
        - StorageService
  /api/v1/users/{id}:
    get:
      operationId: StorageService_GetUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsUser'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
    delete:
      operationId: StorageService_DeleteUser
      responses:
        "200":
          description: A successful response.
          schema:
            type: object
            properties: {}
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: id
          in: path
          required: true
          type: string
      tags:
        - StorageService
  /api/v1/users/{user.id}:
    put:
      operationId: StorageService_UpdateUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsUser'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: user.id
          description: Unique identifier (UUID)
          in: path
          required: true
          type: string
        - name: user
          description: Must include ID and fields to update
          in: body
          required: true
          schema:
            type: object
            properties:
              name:
                type: string
                title: User's display name
              email:
                type: string
                title: User's email address (used for login/notifications)
              preferences:
                type: object
                additionalProperties:
                  type: string
                title: User-specific settings (e.g., default currency, notification preferences)
              createdAt:
                type: string
                format: date-time
                title: Timestamp of registration
              updatedAt:
                type: string
                format: date-time
                title: Timestamp of last profile update
            title: Must include ID and fields to update
        - name: updateMask
          in: query
          required: false
          type: string
      tags:
        - StorageService
  /api/v1/users/{userId}/preferences:
    put:
      summary: Updates user-specific preferences.
      operationId: UserService_UpdateUserPreferences
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/modelsUser'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: userId
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/UserServiceUpdateUserPreferencesBody'
      tags:
        - UserService
definitions:
  AssetServiceEnrichAssetDataBody:
    type: object
    properties:
      sources:
        type: array
        items:
          type: string
        title: 'Optional: specify sources like "market_cap_provider", "fundamental_data_provider"'
  PortfolioServiceCalculatePortfolioValueBody:
    type: object
    properties:
      quoteAssetId:
        type: string
        title: e.g., "USD", "BTC" - the currency to calculate value in
      atTime:
        type: string
        format: date-time
        title: 'Optional: Calculate value at a specific point in time (requires price history)'
  PortfolioServiceGetPortfolioPerformanceBody:
    type: object
    properties:
      from:
        type: string
        format: date-time
      to:
        type: string
        format: date-time
      benchmarkAssetId:
        type: string
        title: 'Optional: Asset to compare performance against (e.g., BTC, SPY)'
  RuleServiceCancelRuleExecutionBody:
    type: object
    properties:
      reason:
        type: string
  RuleServiceDisableRuleBody:
    type: object
  RuleServiceEnableRuleBody:
    type: object
    title: Rule status management messages
  RuleServiceExecuteRuleAsyncBody:
    type: object
    properties:
      dryRun:
        type: boolean
      executionContext:
        type: string
  RuleServiceExecuteRuleBody:
    type: object
    properties:
      dryRun:
        type: boolean
      executionContext:
        type: string
    title: Rule execution messages
  RuleServicePauseRuleBody:
    type: object
    properties:
      reason:
        type: string
  RuleServiceResumeRuleBody:
    type: object
  RuleServiceSimulateRuleBody:
    type: object
    properties:
      simulateAt:
        type: string
        format: date-time
      includeCosts:
        type: boolean
  UserServiceUpdateUserPreferencesBody:
    type: object
    properties:
      preferencesToUpdate:
        type: object
        additionalProperties:
          type: string
        title: Only the preferences to change
      updateMask:
        type: string
        title: Alternatively, use a mask to specify which keys in the map to update/delete
  modelsAPIKey:
    type: object
    properties:
      id:
        type: string
      name:
        type: string
      description:
        type: string
      userId:
        type: string
      scopes:
        type: array
        items:
          type: string
      createdAt:
        type: string
        format: date-time
      lastUsedAt:
        type: string
        format: date-time
      expiresAt:
        type: string
        format: date-time
      enabled:
        type: boolean
      keyPrefix:
        type: string
        title: First 8 characters for display
      usageCount:
        type: integer
        format: int32
      rateLimit:
        $ref: '#/definitions/modelsRateLimitConfig'
    title: APIKey represents an API key for authentication
  modelsAccount:
    type: object
    properties:
      id:
        type: string
        title: Unique identifier (UUID)
      userId:
        type: string
        title: ID of the user owning this account
      name:
        type: string
        title: User-defined name (e.g., "My Binance Spot", "Ledger Nano S")
      description:
        type: string
        title: Optional longer description
      type:
        $ref: '#/definitions/modelsAccountType'
        title: Type of the account
      data:
        type: object
        additionalProperties:
          type: string
        description: Flexible map for connection parameters, API keys, addresses etc. Needs careful handling due to sensitive data.
      createdAt:
        type: string
        format: date-time
        title: Timestamp of creation
      updatedAt:
        type: string
        format: date-time
        title: Timestamp of last update
      subtype:
        $ref: '#/definitions/modelsExchangeAccountSubtype'
        description: Sub-type for exchange accounts (spot, futures, margin)
        title: Exchange-specific fields (optional, only for ACCOUNT_TYPE_EXCHANGE)
      parentAccountId:
        type: string
        title: Parent account ID for hierarchical structure (e.g., futures under main exchange account)
      externalApiKeyId:
        type: string
        title: Direct reference to ExternalAPIKey for this account
    description: |-
      Account represents a user's connection to an external financial entity
      (like an exchange account, bank account, or a self-custody wallet).
      It holds metadata and potentially credentials (in 'data' field) needed to interact.
  modelsAccountType:
    type: string
    enum:
      - ACCOUNT_TYPE_UNSPECIFIED
      - ACCOUNT_TYPE_WALLET
      - ACCOUNT_TYPE_EXCHANGE
      - ACCOUNT_TYPE_BANK
      - ACCOUNT_TYPE_BROKER
    default: ACCOUNT_TYPE_UNSPECIFIED
  modelsAsset:
    type: object
    properties:
      id:
        type: string
      name:
        type: string
      type:
        $ref: '#/definitions/modelsAssetType'
      symbol:
        type: string
      tags:
        type: array
        items:
          type: string
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
    description: Asset represents financial instrument (crypto, stock, etc.).
  modelsAssetType:
    type: string
    enum:
      - ASSET_TYPE_UNSPECIFIED
      - ASSET_TYPE_CRYPTOCURRENCY
      - ASSET_TYPE_STOCK
      - ASSET_TYPE_BOND
      - ASSET_TYPE_COMMODITY
      - ASSET_TYPE_FOREX
      - ASSET_TYPE_FUND
    default: ASSET_TYPE_UNSPECIFIED
  modelsExchangeAccountSubtype:
    type: string
    enum:
      - EXCHANGE_ACCOUNT_SUBTYPE_UNSPECIFIED
      - EXCHANGE_ACCOUNT_SUBTYPE_SPOT
      - EXCHANGE_ACCOUNT_SUBTYPE_FUTURES
      - EXCHANGE_ACCOUNT_SUBTYPE_MARGIN
      - EXCHANGE_ACCOUNT_SUBTYPE_SAVINGS
    default: EXCHANGE_ACCOUNT_SUBTYPE_UNSPECIFIED
    description: |-
      - EXCHANGE_ACCOUNT_SUBTYPE_SPOT: Spot trading account
       - EXCHANGE_ACCOUNT_SUBTYPE_FUTURES: Futures trading account
       - EXCHANGE_ACCOUNT_SUBTYPE_MARGIN: Margin trading account
       - EXCHANGE_ACCOUNT_SUBTYPE_SAVINGS: Savings/staking account
    title: ExchangeAccountSubtype specifies the sub-type for exchange accounts
  modelsExecutionStatus:
    type: string
    enum:
      - EXECUTION_STATUS_UNKNOWN
      - EXECUTION_STATUS_PENDING
      - EXECUTION_STATUS_IN_PROGRESS
      - EXECUTION_STATUS_COMPLETED
      - EXECUTION_STATUS_FAILED
      - EXECUTION_STATUS_CANCELLED
    default: EXECUTION_STATUS_UNKNOWN
    title: ExecutionStatus indicates the status of a rule execution
  modelsExternalAPIKey:
    type: object
    properties:
      id:
        type: string
      userId:
        type: string
        title: User ID (null for system-wide keys)
      provider:
        type: string
        title: e.g., "binance", "gate.io", "coingecko"
      encryptedApiKey:
        type: string
      encryptedApiSecret:
        type: string
      encryptedPassphrase:
        type: string
        title: For some exchanges
      sandbox:
        type: boolean
        title: Whether this is a sandbox/test key
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
      isSystemKey:
        type: boolean
        description: True if this is a system-wide key (user_id should be null)
        title: System key support
      allowedUserIds:
        type: array
        items:
          type: string
        title: Whitelist of users who can use this key (empty = all users)
      permissions:
        type: array
        items:
          type: string
        title: e.g., ["read", "trade", "withdraw"]
      status:
        $ref: '#/definitions/modelsKeyStatus'
        description: Current status of the key
        title: Lifecycle management
      expiresAt:
        type: string
        format: date-time
        title: Expiration time (optional)
      lastUsedAt:
        type: string
        format: date-time
        title: Last time key was used
      usageCount:
        type: integer
        format: int32
        title: Number of times key has been used
    title: |-
      ExternalAPIKey stores encrypted external API credentials
      Supports both user-specific and system-wide API keys
  modelsHolding:
    type: object
    properties:
      id:
        type: string
        title: Unique identifier (UUID)
      amount:
        type: string
        format: int64
        title: Value of the asset in the smallest unit
      decimals:
        type: integer
        format: int64
        title: Number of decimal places for the amount
      assetId:
        type: string
        title: ID of the Asset
      accountId:
        type: string
        title: ID of the Account where the asset is held
      portfolioId:
        type: string
        title: ID of the Portfolio this holding belongs to
      createdAt:
        type: string
        format: date-time
        title: Timestamp of creation
      updatedAt:
        type: string
        format: date-time
        title: Timestamp of last update
    description: |-
      Holding represents a specific quantity of an Asset held within an Account
      and associated with a Portfolio.
  modelsKeyStatus:
    type: string
    enum:
      - KEY_STATUS_UNSPECIFIED
      - KEY_STATUS_ACTIVE
      - KEY_STATUS_DISABLED
      - KEY_STATUS_EXPIRED
      - KEY_STATUS_REVOKED
    default: KEY_STATUS_UNSPECIFIED
    title: KeyStatus represents the status of an API key
  modelsNotificationType:
    type: string
    enum:
      - NOTIFICATION_TYPE_UNSPECIFIED
      - NOTIFICATION_TYPE_ALERT
      - NOTIFICATION_TYPE_SYSTEM
      - NOTIFICATION_TYPE_REPORT
    default: NOTIFICATION_TYPE_UNSPECIFIED
    description: |-
      - NOTIFICATION_TYPE_ALERT: Rule-triggered alerts (price, portfolio, etc.)
       - NOTIFICATION_TYPE_SYSTEM: System status, sync, trade confirmations
       - NOTIFICATION_TYPE_REPORT: Scheduled reports (weekly, monthly)
    title: |-
      Simplified transport-focused notification types
      Business logic conditions moved to Rule system
  modelsPortfolio:
    type: object
    properties:
      id:
        type: string
        title: Unique identifier (UUID)
      userId:
        type: string
        title: ID of the user owning this portfolio
      name:
        type: string
        title: User-defined name (e.g., "Long Term Crypto", "Trading")
      description:
        type: string
        title: Optional longer description
      data:
        type: object
        additionalProperties:
          $ref: '#/definitions/protobufAny'
        title: Additional data (e.g., strategy, notes, regulated balance of assets, etc.)
      createdAt:
        type: string
        format: date-time
        title: Timestamp of creation
      updatedAt:
        type: string
        format: date-time
        title: Timestamp of last update
    description: |-
      Portfolio represents a collection of holdings (assets) managed by a user.
      It's used for tracking performance and overall value.
  modelsPrice:
    type: object
    properties:
      id:
        type: string
        title: Unique identifier (UUID)
      sourceId:
        type: string
        title: Identifier for the source (e.g., "coingecko", "binance")
      assetId:
        type: string
        title: ID of the Asset whose price is represented
      baseAssetId:
        type: string
        title: ID of the Asset against which the price is quoted (e.g., USDT, USD, BTC)
      interval:
        type: string
        description: |-
          Interval defines the time period this price data represents.
          Examples: "1m", "5m", "1h", "4h", "1d", "tick", "latest".
          Empty or "latest" might indicate a snapshot price rather than a full candle.
      decimals:
        type: integer
        format: int64
        title: The decimals of the prices and volume
      last:
        type: string
        format: int64
        title: The latest price of the asset
      open:
        type: string
        format: int64
        description: |-
          OHLCV data - applicable when 'interval' represents a standard candle type (e.g., "1m", "1h").
          These fields might be 0 or unset if the price represents a 'latest' snapshot or 'tick'.
      high:
        type: string
        format: int64
      low:
        type: string
        format: int64
      close:
        type: string
        format: int64
      volume:
        type: string
        format: int64
        title: Trading volume during the interval
      timestamp:
        type: string
        format: date-time
        description: The closing time of the interval or the time of the snapshot/tick.
    description: |-
      Represents the price action of an Asset against a base Asset
      over a specific interval (candle/OHLCV) or as a latest snapshot.
  modelsRateLimitConfig:
    type: object
    properties:
      requestsPerMinute:
        type: integer
        format: int32
      requestsPerHour:
        type: integer
        format: int32
      requestsPerDay:
        type: integer
        format: int32
    title: RateLimitConfig defines rate limiting for API keys
  modelsRule:
    type: object
    properties:
      id:
        type: string
      name:
        type: string
      description:
        type: string
      ruleType:
        type: string
        title: e.g., "target_allocation", "monthly_withdrawal", "stop_loss", "dca"
      portfolioId:
        type: string
      userId:
        type: string
      status:
        $ref: '#/definitions/modelsRuleStatus'
      configuration:
        type: object
        title: Flexible configuration for any rule type
      schedule:
        $ref: '#/definitions/modelsRuleSchedule'
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
    title: Rule defines a business rule that can be applied to portfolios
  modelsRuleExecution:
    type: object
    properties:
      id:
        type: string
      ruleId:
        type: string
      portfolioId:
        type: string
        title: Optional scope - inherited from rule if not specified
      userId:
        type: string
      startedAt:
        type: string
        format: date-time
      completedAt:
        type: string
        format: date-time
      status:
        $ref: '#/definitions/modelsExecutionStatus'
      errorMessage:
        type: string
      createdTransactionIds:
        type: array
        items:
          type: string
        title: Results produced by execution
      affectedHoldingIds:
        type: array
        items:
          type: string
      transactionsCreated:
        type: integer
        format: int32
        title: Execution metrics
      executionSummary:
        type: object
        title: Rule-type specific execution details
    title: RuleExecution represents a single execution of a rule
  modelsRuleSchedule:
    type: object
    properties:
      cronExpression:
        type: string
        title: Cron expression for scheduling
      timezone:
        type: string
        title: Timezone for execution
      oneTime:
        type: boolean
        title: If true, rule executes only once
      executeAfter:
        type: string
        format: date-time
        title: For delayed execution
    title: RuleSchedule defines when a rule should be executed
  modelsRuleStatus:
    type: string
    enum:
      - RULE_STATUS_UNKNOWN
      - RULE_STATUS_ACTIVE
      - RULE_STATUS_PAUSED
      - RULE_STATUS_DISABLED
      - RULE_STATUS_ERROR
    default: RULE_STATUS_UNKNOWN
    title: RuleStatus indicates the current status of a rule
  modelsSessionContext:
    type: object
    properties:
      telegramId:
        type: string
        title: Telegram user ID
      currentOperation:
        type: string
        description: 'Current operation: "trade", "portfolio_view", etc.'
      contextData:
        type: object
        additionalProperties:
          type: string
        title: Key-value context data
      expiresAt:
        type: string
        format: date-time
        title: Session expiration time
      conversationHistory:
        type: array
        items:
          type: string
        title: Recent conversation history
      state:
        type: string
        title: Current conversation state
    title: SessionContext represents user conversation state
  modelsTelegramAlert:
    type: object
    properties:
      id:
        type: string
        title: Alert ID
      telegramId:
        type: string
        title: Owner Telegram ID
      ruleId:
        type: string
        title: Link to Rule (business logic)
      customMessage:
        type: string
        title: Custom Telegram message template (optional)
      enabled:
        type: boolean
        title: Whether Telegram delivery is enabled
      createdAt:
        type: string
        format: date-time
      lastTriggered:
        type: string
        format: date-time
      triggerCount:
        type: integer
        format: int32
        title: Telegram delivery count
    title: |-
      TelegramAlert represents transport-specific alert configuration
      Business logic moved to Rule system - this handles only Telegram-specific concerns
  modelsTelegramNotification:
    type: object
    properties:
      telegramId:
        type: string
        title: Target user Telegram ID
      type:
        $ref: '#/definitions/modelsNotificationType'
        title: Notification type
      title:
        type: string
        title: Notification title
      message:
        type: string
        title: Notification message
      assetSymbol:
        type: string
        title: Related asset (if applicable)
      portfolioId:
        type: string
        title: Related portfolio (if applicable)
      value:
        type: number
        format: double
        title: Related value (price, change, etc.)
      createdAt:
        type: string
        format: date-time
      sent:
        type: boolean
        title: Whether notification was sent successfully
    title: Notification represents push notification to user
  modelsTelegramUser:
    type: object
    properties:
      telegramId:
        type: string
        title: Telegram user ID
      userId:
        type: string
        title: System User ID (link to User model)
      username:
        type: string
        title: Telegram username (@username)
      firstName:
        type: string
        title: User's first name in Telegram
      lastName:
        type: string
        title: User's last name in Telegram
      languageCode:
        type: string
        title: User's language preference (ru, en)
      notificationsEnabled:
        type: boolean
        title: Whether notifications are enabled
      subscribedAlerts:
        type: array
        items:
          type: string
        title: List of alert types user subscribed to
      createdAt:
        type: string
        format: date-time
      lastActive:
        type: string
        format: date-time
    title: TelegramUser represents a user linked between Telegram and the system
  modelsTransaction:
    type: object
    properties:
      id:
        type: string
        title: Unique identifier (UUID)
      createdAt:
        type: string
        format: date-time
        title: Timestamp when the transaction occurred or was recorded
      updatedAt:
        type: string
        format: date-time
        title: Timestamp of last status update
      type:
        $ref: '#/definitions/modelsTransactionType'
        title: Type of the transaction
      status:
        $ref: '#/definitions/modelsTransactionStatus'
        title: Current status of the transaction
      accountId:
        type: string
        title: ID of the Account involved in the transaction
      data:
        type: object
        additionalProperties:
          type: string
        title: Transaction data (e.g., external transaction ID, notes, )
    description: Transaction represents a financial event involving assets, accounts, and portfolios.
  modelsTransactionStatus:
    type: string
    enum:
      - TRANSACTION_STATUS_UNSPECIFIED
      - TRANSACTION_STATUS_PENDING
      - TRANSACTION_STATUS_PROCESSING
      - TRANSACTION_STATUS_COMPLETED
      - TRANSACTION_STATUS_FAILED
      - TRANSACTION_STATUS_CANCELLED
    default: TRANSACTION_STATUS_UNSPECIFIED
    title: |-
      - TRANSACTION_STATUS_PENDING: Transaction initiated but not confirmed
       - TRANSACTION_STATUS_PROCESSING: Transaction is being processed
       - TRANSACTION_STATUS_COMPLETED: Transaction successfully completed
       - TRANSACTION_STATUS_FAILED: Transaction failed
       - TRANSACTION_STATUS_CANCELLED: Transaction cancelled before completion
  modelsTransactionType:
    type: string
    enum:
      - TRANSACTION_TYPE_UNSPECIFIED
      - TRANSACTION_TYPE_EXTENDED
      - TRANSACTION_TYPE_TRADE
      - TRANSACTION_TYPE_TRANSFER
      - TRANSACTION_TYPE_DEPOSIT
      - TRANSACTION_TYPE_WITHDRAWAL
    default: TRANSACTION_TYPE_UNSPECIFIED
    title: |-
      - TRANSACTION_TYPE_EXTENDED: Complex transactionsz: DeFi, NFT, Governance, Gaming, etc.
       - TRANSACTION_TYPE_TRADE: Echanging one asset for another
       - TRANSACTION_TYPE_TRANSFER: Transferring asset between accounts (internal or external)
       - TRANSACTION_TYPE_DEPOSIT: Depositing asset into an account from outside the system
       - TRANSACTION_TYPE_WITHDRAWAL: Withdrawing asset from an account to outside the system
  modelsUser:
    type: object
    properties:
      id:
        type: string
        title: Unique identifier (UUID)
      name:
        type: string
        title: User's display name
      email:
        type: string
        title: User's email address (used for login/notifications)
      preferences:
        type: object
        additionalProperties:
          type: string
        title: User-specific settings (e.g., default currency, notification preferences)
      createdAt:
        type: string
        format: date-time
        title: Timestamp of registration
      updatedAt:
        type: string
        format: date-time
        title: Timestamp of last profile update
    description: User represents a user of the Greedy-Eye system.
  protobufAny:
    type: object
    properties:
      '@type':
        type: string
        description: |-
          A URL/resource name that uniquely identifies the type of the serialized
          protocol buffer message. This string must contain at least
          one "/" character. The last segment of the URL's path must represent
          the fully qualified name of the type (as in
          `path/google.protobuf.Duration`). The name should be in a canonical form
          (e.g., leading "." is not accepted).

          In practice, teams usually precompile into the binary all types that they
          expect it to use in the context of Any. However, for URLs which use the
          scheme `http`, `https`, or no scheme, one can optionally set up a type
          server that maps type URLs to message definitions as follows:

          * If no scheme is provided, `https` is assumed.
          * An HTTP GET on the URL must yield a [google.protobuf.Type][]
            value in binary format, or produce an error.
          * Applications are allowed to cache lookup results based on the
            URL, or have them precompiled into a binary to avoid any
            lookup. Therefore, binary compatibility needs to be preserved
            on changes to types. (Use versioned type names to manage
            breaking changes.)

          Note: this functionality is not currently available in the official
          protobuf release, and it is not used for type URLs beginning with
          type.googleapis.com. As of May 2023, there are no widely used type server
          implementations and no plans to implement one.

          Schemes other than `http`, `https` (or the empty scheme) might be
          used with implementation specific semantics.
    additionalProperties: {}
    description: |-
      `Any` contains an arbitrary serialized protocol buffer message along with a
      URL that describes the type of the serialized message.

      Protobuf library provides support to pack/unpack Any values in the form
      of utility functions or additional generated methods of the Any type.

      Example 1: Pack and unpack a message in C++.

          Foo foo = ...;
          Any any;
          any.PackFrom(foo);
          ...
          if (any.UnpackTo(&foo)) {
            ...
          }

      Example 2: Pack and unpack a message in Java.

          Foo foo = ...;
          Any any = Any.pack(foo);
          ...
          if (any.is(Foo.class)) {
            foo = any.unpack(Foo.class);
          }
          // or ...
          if (any.isSameTypeAs(Foo.getDefaultInstance())) {
            foo = any.unpack(Foo.getDefaultInstance());
          }

       Example 3: Pack and unpack a message in Python.

          foo = Foo(...)
          any = Any()
          any.Pack(foo)
          ...
          if any.Is(Foo.DESCRIPTOR):
            any.Unpack(foo)
            ...

       Example 4: Pack and unpack a message in Go

           foo := &pb.Foo{...}
           any, err := anypb.New(foo)
           if err != nil {
             ...
           }
           ...
           foo := &pb.Foo{}
           if err := any.UnmarshalTo(foo); err != nil {
             ...
           }

      The pack methods provided by protobuf library will by default use
      'type.googleapis.com/full.type.name' as the type URL and the unpack
      methods only use the fully qualified type name after the last '/'
      in the type URL, for example "foo.bar.com/x/y.z" will yield type
      name "y.z".

      JSON
      ====
      The JSON representation of an `Any` value uses the regular
      representation of the deserialized, embedded message, with an
      additional field `@type` which contains the type URL. Example:

          package google.profile;
          message Person {
            string first_name = 1;
            string last_name = 2;
          }

          {
            "@type": "type.googleapis.com/google.profile.Person",
            "firstName": <string>,
            "lastName": <string>
          }

      If the embedded message type is well-known and has a custom JSON
      representation, that representation will be embedded adding a field
      `value` which holds the custom JSON in addition to the `@type`
      field. Example (for message [google.protobuf.Duration][]):

          {
            "@type": "type.googleapis.com/google.protobuf.Duration",
            "value": "1.212s"
          }
  protobufNullValue:
    type: string
    enum:
      - NULL_VALUE
    default: NULL_VALUE
    description: |-
      `NullValue` is a singleton enumeration to represent the null value for the
      `Value` type union.

      The JSON representation for `NullValue` is JSON `null`.

       - NULL_VALUE: Null value.
  rpcStatus:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      details:
        type: array
        items:
          type: object
          $ref: '#/definitions/protobufAny'
  servicesAlertOperation:
    type: string
    enum:
      - ALERT_OPERATION_UNSPECIFIED
      - ALERT_OPERATION_CREATE
      - ALERT_OPERATION_UPDATE
      - ALERT_OPERATION_DELETE
      - ALERT_OPERATION_LIST
    default: ALERT_OPERATION_UNSPECIFIED
  servicesAssetAllocation:
    type: object
    properties:
      assetId:
        type: string
      currentAmount:
        type: number
        format: double
      currentPercentage:
        type: number
        format: double
      targetPercentage:
        type: number
        format: double
      difference:
        type: number
        format: double
  servicesAssetStopLoss:
    type: object
    properties:
      assetId:
        type: string
      currentAmount:
        type: number
        format: double
      amountToSell:
        type: number
        format: double
      estimatedValue:
        type: number
        format: double
  servicesAssetWithdrawalPlan:
    type: object
    properties:
      assetId:
        type: string
      amountToWithdraw:
        type: number
        format: double
      estimatedValue:
        type: number
        format: double
      needsSelling:
        type: boolean
  servicesAudioFormat:
    type: string
    enum:
      - AUDIO_FORMAT_UNSPECIFIED
      - AUDIO_FORMAT_OGG
      - AUDIO_FORMAT_MP3
      - AUDIO_FORMAT_WAV
      - AUDIO_FORMAT_M4A
    default: AUDIO_FORMAT_UNSPECIFIED
  servicesBotStats:
    type: object
    properties:
      totalUsers:
        type: integer
        format: int32
        title: Total registered users
      activeUsersToday:
        type: integer
        format: int32
        title: Users active in last 24h
      activeUsersWeek:
        type: integer
        format: int32
        title: Users active in last 7 days
      totalMessagesToday:
        type: integer
        format: int32
        title: Total messages processed today
      totalCommandsToday:
        type: integer
        format: int32
        title: Total commands processed today
      totalVoiceToday:
        type: integer
        format: int32
        title: Total voice messages today
      averageResponseTimeMs:
        type: integer
        format: int32
        title: Average response time
      errorRatePercent:
        type: integer
        format: int32
        title: Error rate percentage
      popularCommands:
        type: object
        additionalProperties:
          type: integer
          format: int32
        title: Command usage statistics
      errorTypes:
        type: object
        additionalProperties:
          type: integer
          format: int32
        title: Error type statistics
      lastUpdated:
        type: string
        format: date-time
  servicesConvertTextToSpeechRequest:
    type: object
    properties:
      text:
        type: string
        title: Text to convert to speech
      language:
        type: string
        title: Language for TTS (ru, en)
      voice:
        type: string
        title: Voice name/ID
      provider:
        $ref: '#/definitions/servicesSpeechProvider'
        title: Preferred TTS provider
      outputFormat:
        $ref: '#/definitions/servicesAudioFormat'
        title: Output audio format
  servicesConvertTextToSpeechResponse:
    type: object
    properties:
      success:
        type: boolean
      audioData:
        type: string
        format: byte
        title: Generated audio data
      audioFormat:
        type: string
        title: Audio format
      durationSeconds:
        type: integer
        format: int32
        title: Audio duration
      errorMessage:
        type: string
      processingTimeMs:
        type: integer
        format: int32
  servicesCreateJWTRequest:
    type: object
    properties:
      userId:
        type: string
      scopes:
        type: array
        items:
          type: string
      expiresInSeconds:
        type: string
        format: int64
      apiKeyId:
        type: string
        title: Reference to API key used for authentication
    title: JWT messages
  servicesCreateJWTResponse:
    type: object
    properties:
      accessToken:
        type: string
      refreshToken:
        type: string
      expiresIn:
        type: string
        format: int64
      tokenType:
        type: string
  servicesCreatePricesResponse:
    type: object
    properties:
      createdCount:
        type: integer
        format: int32
        title: Number of prices successfully created
  servicesDCASimulation:
    type: object
    properties:
      availableBalance:
        type: number
        format: double
      dcaAmount:
        type: number
        format: double
      targetAssetId:
        type: string
      estimatedPurchaseAmount:
        type: number
        format: double
      estimatedPrice:
        type: number
        format: double
      estimatedFee:
        type: number
        format: double
      sufficientFunds:
        type: boolean
  servicesExecuteRuleAsyncResponse:
    type: object
    properties:
      executionId:
        type: string
      status:
        type: string
  servicesExecuteRuleResponse:
    type: object
    properties:
      execution:
        $ref: '#/definitions/modelsRuleExecution'
  servicesFetchExternalPricesRequest:
    type: object
    properties:
      sourceIds:
        type: array
        items:
          type: string
        title: 'Optional: Fetch only from specific sources (e.g., ["coingecko", "binance"])'
      assetIds:
        type: array
        items:
          type: string
        title: 'Optional: Fetch only for specific assets'
  servicesFetchExternalPricesResponse:
    type: object
    properties:
      pricesFetched:
        type: integer
        format: int32
      pricesStored:
        type: integer
        format: int32
      errors:
        type: array
        items:
          type: string
        title: List of errors encountered during fetching/storing
  servicesGetBotStatsResponse:
    type: object
    properties:
      stats:
        $ref: '#/definitions/servicesBotStats'
  servicesGetTelegramUserResponse:
    type: object
    properties:
      telegramUser:
        $ref: '#/definitions/modelsTelegramUser'
      exists:
        type: boolean
  servicesGetUserSessionResponse:
    type: object
    properties:
      session:
        $ref: '#/definitions/modelsSessionContext'
      exists:
        type: boolean
        title: Whether session exists
  servicesListAPIKeysResponse:
    type: object
    properties:
      apiKeys:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsAPIKey'
      nextPageToken:
        type: string
  servicesListAccountsResponse:
    type: object
    properties:
      accounts:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsAccount'
      nextPageToken:
        type: string
  servicesListAssetsResponse:
    type: object
    properties:
      assets:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsAsset'
      nextPageToken:
        type: string
        title: Token for the next page, empty if no more pages
  servicesListExternalAPIKeysResponse:
    type: object
    properties:
      externalApiKeys:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsExternalAPIKey'
      nextPageToken:
        type: string
  servicesListHoldingsResponse:
    type: object
    properties:
      holdings:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsHolding'
      nextPageToken:
        type: string
  servicesListPortfoliosResponse:
    type: object
    properties:
      portfolios:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsPortfolio'
      nextPageToken:
        type: string
  servicesListPriceHistoryResponse:
    type: object
    properties:
      prices:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsPrice'
      nextPageToken:
        type: string
  servicesListRuleExecutionsResponse:
    type: object
    properties:
      ruleExecutions:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsRuleExecution'
      nextPageToken:
        type: string
  servicesListRulesResponse:
    type: object
    properties:
      rules:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsRule'
      nextPageToken:
        type: string
  servicesListTransactionsResponse:
    type: object
    properties:
      transactions:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsTransaction'
      nextPageToken:
        type: string
  servicesManageAlertsRequest:
    type: object
    properties:
      telegramId:
        type: string
      operation:
        $ref: '#/definitions/servicesAlertOperation'
        title: CREATE, UPDATE, DELETE, LIST
      alert:
        $ref: '#/definitions/modelsTelegramAlert'
        title: Alert data (for CREATE/UPDATE)
      alertId:
        type: string
        title: Alert ID (for UPDATE/DELETE)
    title: Alert Management
  servicesManageAlertsResponse:
    type: object
    properties:
      success:
        type: boolean
      alerts:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsTelegramAlert'
        title: List of alerts (for LIST operation)
      errorMessage:
        type: string
  servicesPlannedTrade:
    type: object
    properties:
      assetId:
        type: string
      action:
        type: string
        title: '"buy" or "sell"'
      amount:
        type: number
        format: double
      estimatedPrice:
        type: number
        format: double
      estimatedFee:
        type: number
        format: double
  servicesPortfolioPerformanceResponse:
    type: object
    properties:
      portfolioId:
        type: string
      returnPercentage:
        type: number
        format: double
        title: 'Various performance metrics:'
      volatility:
        type: number
        format: double
      sharpeRatio:
        type: number
        format: double
        title: Example metric
  servicesPortfolioValueResponse:
    type: object
    properties:
      portfolioId:
        type: string
      quoteAssetId:
        type: string
      totalValueAmount:
        type: string
        format: int64
        title: Monetary value represented by amount and decimals. real_value = amount / (10^decimals)
      decimals:
        type: integer
        format: int64
      calculationTime:
        type: string
        format: date-time
        title: Could also include breakdown by asset
  servicesProcessTelegramUpdateRequest:
    type: object
    properties:
      updateJson:
        type: string
        title: Raw Telegram update JSON
      webhookSecret:
        type: string
        title: Webhook verification secret
    title: Telegram Update Processing
  servicesProcessTelegramUpdateResponse:
    type: object
    properties:
      success:
        type: boolean
        title: Whether update was processed successfully
      errorMessage:
        type: string
        title: Error message if processing failed
      responseSent:
        type: string
        title: Response that was sent to user (for logging)
  servicesProcessVoiceMessageRequest:
    type: object
    properties:
      telegramId:
        type: string
      audioData:
        type: string
        format: byte
        title: Audio file data
      audioFormat:
        type: string
        title: Audio format (ogg, mp3, wav, etc.)
      durationSeconds:
        type: integer
        format: int32
        title: Audio duration
      languageHint:
        type: string
        title: Language hint for STT (ru, en, auto)
      provider:
        $ref: '#/definitions/servicesSpeechProvider'
        title: Preferred STT provider
    title: Speech Processing
  servicesProcessVoiceMessageResponse:
    type: object
    properties:
      success:
        type: boolean
      transcribedText:
        type: string
        title: Transcribed text from audio
      detectedLanguage:
        type: string
        title: Detected language
      confidence:
        type: number
        format: float
        title: Transcription confidence (0.0-1.0)
      errorMessage:
        type: string
      processingTimeMs:
        type: integer
        format: int32
        title: Processing time in milliseconds
  servicesRebalancingSimulation:
    type: object
    properties:
      currentTotalValue:
        type: number
        format: double
      currentAllocations:
        type: array
        items:
          type: object
          $ref: '#/definitions/servicesAssetAllocation'
      targetAllocations:
        type: array
        items:
          type: object
          $ref: '#/definitions/servicesAssetAllocation'
      plannedTrades:
        type: array
        items:
          type: object
          $ref: '#/definitions/servicesPlannedTrade'
      totalEstimatedFees:
        type: number
        format: double
  servicesRefreshJWTRequest:
    type: object
    properties:
      refreshToken:
        type: string
  servicesRefreshJWTResponse:
    type: object
    properties:
      accessToken:
        type: string
      refreshToken:
        type: string
      expiresIn:
        type: string
        format: int64
  servicesRegisterTelegramUserRequest:
    type: object
    properties:
      telegramUser:
        $ref: '#/definitions/modelsTelegramUser'
      linkExistingUser:
        type: boolean
        title: Try to link with existing user by email/phone
      existingUserId:
        type: string
        title: Explicit user ID to link with
    title: User Registration
  servicesRegisterTelegramUserResponse:
    type: object
    properties:
      success:
        type: boolean
      userId:
        type: string
        title: System user ID that was linked
      isNewUser:
        type: boolean
        title: Whether this is a new user registration
      errorMessage:
        type: string
  servicesSendBulkNotificationsRequest:
    type: object
    properties:
      notifications:
        type: array
        items:
          type: object
          $ref: '#/definitions/modelsTelegramNotification'
      batchSize:
        type: integer
        format: int32
        title: 'Batch size for rate limiting (default: 30)'
      delayMs:
        type: integer
        format: int32
        title: 'Delay between batches in milliseconds (default: 1000)'
  servicesSendBulkNotificationsResponse:
    type: object
    properties:
      sentCount:
        type: integer
        format: int32
        title: Number of notifications sent successfully
      failedCount:
        type: integer
        format: int32
        title: Number of failed notifications
      errors:
        type: array
        items:
          type: string
        title: List of error messages for failed notifications
  servicesSendNotificationRequest:
    type: object
    properties:
      notification:
        $ref: '#/definitions/modelsTelegramNotification'
      forceSend:
        type: boolean
        title: Send even if user has notifications disabled
    title: Notifications
  servicesSendNotificationResponse:
    type: object
    properties:
      sent:
        type: boolean
        title: Whether notification was sent successfully
      messageId:
        type: string
        title: Telegram message ID if sent
      errorMessage:
        type: string
        title: Error message if sending failed
  servicesSimulateRuleResponse:
    type: object
    properties:
      success:
        type: boolean
      result:
        $ref: '#/definitions/servicesSimulationResult'
      warnings:
        type: array
        items:
          type: string
      errorMessage:
        type: string
  servicesSimulationResult:
    type: object
    properties:
      estimatedCost:
        type: number
        format: double
      estimatedSteps:
        type: integer
        format: int32
      estimatedDurationMs:
        type: string
        format: int64
      rebalancing:
        $ref: '#/definitions/servicesRebalancingSimulation'
      withdrawal:
        $ref: '#/definitions/servicesWithdrawalSimulation'
      stopLoss:
        $ref: '#/definitions/servicesStopLossSimulation'
      dca:
        $ref: '#/definitions/servicesDCASimulation'
  servicesSpeechProvider:
    type: string
    enum:
      - SPEECH_PROVIDER_UNSPECIFIED
      - SPEECH_PROVIDER_GOOGLE
      - SPEECH_PROVIDER_OPENAI
      - SPEECH_PROVIDER_YANDEX
      - SPEECH_PROVIDER_AUTO
    default: SPEECH_PROVIDER_UNSPECIFIED
    title: '- SPEECH_PROVIDER_AUTO: Automatically select best provider'
  servicesStopLossSimulation:
    type: object
    properties:
      currentPortfolioValue:
        type: number
        format: double
      stopLossThreshold:
        type: number
        format: double
      currentLossPercentage:
        type: number
        format: double
      wouldTrigger:
        type: boolean
      assetActions:
        type: array
        items:
          type: object
          $ref: '#/definitions/servicesAssetStopLoss'
  servicesUpdateUserSessionResponse:
    type: object
    properties:
      success:
        type: boolean
      errorMessage:
        type: string
  servicesValidateJWTRequest:
    type: object
    properties:
      token:
        type: string
      requiredScopes:
        type: array
        items:
          type: string
  servicesValidateJWTResponse:
    type: object
    properties:
      valid:
        type: boolean
      userId:
        type: string
      scopes:
        type: array
        items:
          type: string
      expiresAt:
        type: string
        format: date-time
      errorMessage:
        type: string
  servicesValidateRuleResponse:
    type: object
    properties:
      valid:
        type: boolean
      validationErrors:
        type: array
        items:
          type: string
      warnings:
        type: array
        items:
          type: string
  servicesWithdrawalSimulation:
    type: object
    properties:
      availableBalance:
        type: number
        format: double
      requestedAmount:
        type: number
        format: double
      sufficientFunds:
        type: boolean
      withdrawalPlan:
        type: array
        items:
          type: object
          $ref: '#/definitions/servicesAssetWithdrawalPlan'
